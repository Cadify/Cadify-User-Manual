# üñºÔ∏è CadifyDartImage

The CadifyDartImage function sends a JSON inference request to an external ML service and inserts the generated image directly into an Excel worksheet.

This function is synchronous and compatible with SolidWorks-driven Cadify workflows.

---

## üìå What It Does

CadifyDartImage:
- Sends a JSON payload, typically generated by CadifyDartJson, to an ML endpoint
- Waits synchronously for the response
- Decodes one or more Base64-encoded images
- Inserts the resulting image into the worksheet at a specified target cell
- Manages replacement, caching, and Z-ordering of images automatically

Depending on the selected ML model, different response formats and endpoints are supported.

---

## üßæ Syntax

=CadifyDartImage(ImageId, Endpoint, Json, JsonType, Target, ZOrder, Style, CadifySheetName)

---

## üßÆ Parameters

Parameter: ImageId  
Type: Text  
Description:  
Unique name used to identify the generated image shape in Excel. Used for replacement and deduplication.

Parameter: Endpoint  
Type: Text  
Description:  
URL of the ML endpoint that returns a Base64-encoded image or images.  
If empty and a Floris model is selected, a default Runpod endpoint is used.

Parameter: Json  
Type: Text  
Description:  
JSON payload sent to the ML service, typically produced by CadifyDartJson.

Parameter: JsonType  
Type: Number  
Description:  
Selects the ML model and response handling logic:  
0 = Bodan  
1 = Floris 1B Runpod  
2 = Floris 1B Local  
3 = Bodan 1B  

Parameter: Target  
Type: Text  
Description:  
Excel cell reference indicating the top-left position where the image will be inserted.

Parameter: ZOrder  
Type: Number  
Description:  
Absolute Z-order of the inserted image relative to other shapes.

Parameter: Style  
Type: Text  
Description:  
Image style control.  
If set to SUPPRESS or SUPRESS, the image generation and insertion are skipped.

Parameter: CadifySheetName  
Type: Text  
Description:  
Name of the corresponding CadifySheet function. Used for validation and consistency checks.

---

## üîÅ Output

Returns a status string.

On success:
Function CadifyDartImage: Request completed in <milliseconds> ms

On failure:
- Validation or configuration error messages
- WebException details, including response body if available
- General exception details

---

## ‚öôÔ∏è Behavior and Implementation Details

- The function executes synchronously and blocks until the ML service responds
- The calling cell is used as a cache key to prevent redundant requests
- If the same parameters are recalculated, the function exits without reissuing the request
- Existing images with the same ImageId are removed before inserting a new one
- Images are temporarily written to disk and deleted immediately after insertion
- Aspect ratio is unlocked and the image is sized to match the target cell
- Z-order is applied after insertion

---

## üåê Model-Specific Behavior

Floris models (JsonType 1 and 2):
- Expect image data under output.images, images,
